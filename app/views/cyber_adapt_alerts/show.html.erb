<div class="ui container">
  <h1>
    CyberAdapt Alert #<%= @alert.alert_id %>
  </h1>

  <div class="ui items">
    <div class="item">
      <% if @alert.resolved? %>
        <%= resolve_icon(@alert) %>
        This alert is resolved. Click icon to unresolve.
      <% else %>
        <%= resolve_icon(@alert)%>
        This alert is unresolved. Click icon to resolve.
      <% end %>
    </div>

    <div class="item">
      <div class="content">
        <div class="header">
          <i class="yellow envelope icon"></i>Message
        </div>
        <div class="description">
          <%= @alert.msg %>
        </div>
      </div>
    </div>

    <div class="item">
      <div class="content">
        <div class="header">
          <i class="red desktop icon"></i>
          <i class="angle double right icon"></i>
          Source
        </div>
        <div class="meta">
          <span>
            Click the IP to immediately check it on AbuseIP
          </span>
        </div>
        <div class="description">
          <%= abuse_ip @alert.src_ip %>:<%= @alert.src_port %>
        </div>
      </div>
    </div>

    <div class="item">
      <div class="content">
        <div class="header">
          <i class="green desktop icon"></i>
          <i class="angle double left icon"></i>
          Destination
        </div>
        <div class="meta">
          <span>
            Click the IP to immediately check it on AbuseIP
          </span>
        </div>
        <div class="description">
          <%= abuse_ip @alert.dst_ip %>:<%= @alert.dst_port %>
        </div>
      </div>
    </div>

    <div class="item">
      <div class="content">
        <div class="header">
          <i class="blue clock icon"></i>Timestamp
        </div>
        <div class="description">
          <%= @alert.alert_timestamp %>
        </div>
      </div>
    </div>
  </div>

  <div class="ui message">
    <div class="header">
      Full message payload:
    </div>
    <%= @alert.alert %>
  </div>
</div>
