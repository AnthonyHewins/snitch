<h1>CyberAdapt traffic</h1>
<h3>Total: <%= UriEntry.count %></h3>

<%= form_tag uri_entries_path, method: :get, class: "ui form" do |f| %>
  <div class="ui icon input">
    <%= text_field_tag :q, nil, placeholder: "Search" %>
    <i class="search icon"></i>
  </div>
<% end %>

<%= link_to "Pull new log entries from CyberAdapt", uri_entries_refresh_path %>

<table class="ui striped celled table">
  <thead>
    <tr>
      <th>ID</th>
      <th>User</th>
      <th>Host</th>
      <th>IP</th>
      <th>URI</th>
      <th>Hits</th>
      <th>CyberAdapt recorded this on</th>
      <th>Was put into the database at</th>
      <th>Was last updated at</th>
    </tr>
  </thead>
  <tbody>
    <% @uri_entries.each do |row| %>
      <tr>
        <%= content_tag :td, row.id %>
        <%= content_tag :td, row.machine&.user %>
        <%= content_tag :td, row.machine&.host %>
        <%= content_tag :td, row.machine&.ip %>
        <%= content_tag :td, row.uri %>
        <%= content_tag :td, row.hits %>
        <%= content_tag :td, row.paper_trail&.insertion_date %>
        <%= content_tag :td, row.created_at %>
        <%= content_tag :td, row.updated_at %>
      </tr>
    <% end %>
  </tbody>
</table>
